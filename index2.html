<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digitale Signatur - Interaktiver Lernpfad</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        nav {
            background: #f8f9fa;
            padding: 20px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            border-bottom: 3px solid #667eea;
        }

        .nav-btn {
            padding: 12px 24px;
            background: white;
            border: 2px solid #667eea;
            color: #667eea;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .nav-btn:hover {
            background: #667eea;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .nav-btn.active {
            background: #667eea;
            color: white;
        }

        .content {
            padding: 40px;
            min-height: 500px;
        }

        .section {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 2em;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        h3 {
            color: #764ba2;
            margin-top: 30px;
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .info-box {
            background: #f0f4ff;
            border-left: 5px solid #667eea;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .warning-box {
            background: #fff3cd;
            border-left: 5px solid #ffc107;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .success-box {
            background: #d4edda;
            border-left: 5px solid #28a745;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .interactive-box {
            background: white;
            border: 2px solid #667eea;
            border-radius: 10px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        input[type="text"],
        input[type="number"],
        textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            margin: 10px 0;
            transition: border-color 0.3s ease;
        }

        input[type="text"]:focus,
        input[type="number"]:focus,
        textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        button {
            padding: 12px 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 5px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
        }

        .btn-success {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        }

        .btn-danger {
            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .grid-2,
            .grid-3 {
                grid-template-columns: 1fr;
            }
        }

        .step {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 5px solid #667eea;
        }

        .step-number {
            display: inline-block;
            width: 35px;
            height: 35px;
            background: #667eea;
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 35px;
            font-weight: bold;
            margin-right: 10px;
        }

        .formula {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            overflow-x: auto;
        }

        .result {
            background: #d4edda;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-weight: bold;
            color: #155724;
        }

        .error {
            background: #f8d7da;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-weight: bold;
            color: #721c24;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        th {
            background: #667eea;
            color: white;
            font-weight: 600;
        }

        tr:hover {
            background: #f8f9fa;
        }

        .key-display {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            word-break: break-all;
            margin: 10px 0;
        }

        .visual-diagram {
            background: white;
            border: 2px solid #667eea;
            border-radius: 10px;
            padding: 30px;
            margin: 20px 0;
            text-align: center;
        }

        .arrow {
            font-size: 2em;
            color: #667eea;
            margin: 10px 0;
        }

        .box {
            display: inline-block;
            padding: 15px 25px;
            background: #f0f4ff;
            border: 2px solid #667eea;
            border-radius: 10px;
            margin: 10px;
            font-weight: 600;
        }

        .hash-option {
            display: inline-block;
            padding: 10px 20px;
            margin: 5px;
            background: white;
            border: 2px solid #667eea;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .hash-option:hover {
            background: #f0f4ff;
        }

        .hash-option.selected {
            background: #667eea;
            color: white;
        }

        .copy-btn {
            padding: 8px 16px;
            font-size: 0.9em;
            margin-left: 10px;
        }

        label {
            display: block;
            margin-top: 15px;
            margin-bottom: 5px;
            font-weight: 600;
            color: #333;
        }

        .inline-label {
            display: inline-block;
            margin-right: 10px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid #ddd;
        }

        .tab {
            padding: 12px 24px;
            background: transparent;
            border: none;
            border-bottom: 3px solid transparent;
            color: #666;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .tab:hover {
            color: #667eea;
        }

        .tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: #f0f4ff;
            border-radius: 15px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üîê Digitale Signatur</h1>
            <p>Interaktiver Lernpfad zu Kryptographie und digitalen Signaturen</p>
        </header>

        <nav>
            <button class="nav-btn active" onclick="showSection('home')">üè† Start</button>
            <button class="nav-btn" onclick="showSection('rsa-basics')">üîë RSA Grundlagen</button>
            <button class="nav-btn" onclick="showSection('rsa-practice')">‚úèÔ∏è RSA √úbung</button>
            <button class="nav-btn" onclick="showSection('hash')"># Hash-Funktionen</button>
            <button class="nav-btn" onclick="showSection('signature')">‚úçÔ∏è Digitale Signatur</button>
            <button class="nav-btn" onclick="showSection('practice')">üéØ Praxis-Labor</button>
        </nav>

        <div class="content">
            <!-- HOME SECTION -->
            <div id="home" class="section active">
                <h2>Willkommen zum Lernpfad: Digitale Signatur</h2>
                
                <div class="info-box">
                    <h3>üìö Was lernst du hier?</h3>
                    <p>In diesem interaktiven Lernpfad wirst du verstehen, wie digitale Signaturen funktionieren und warum sie f√ºr sichere Kommunikation unverzichtbar sind.</p>
                </div>

                <h3>üéØ Lernziele</h3>
                <div class="grid-2">
                    <div class="interactive-box">
                        <h4>üîë RSA-Verschl√ºsselung</h4>
                        <p>Wiederholung und Vertiefung des RSA-Algorithmus mit praktischen Beispielen</p>
                    </div>
                    <div class="interactive-box">
                        <h4># Hash-Funktionen</h4>
                        <p>Verstehen, wie Hash-Funktionen Daten in eindeutige Fingerabdr√ºcke umwandeln</p>
                    </div>
                    <div class="interactive-box">
                        <h4>‚úçÔ∏è Digitale Signaturen</h4>
                        <p>Lernen, wie man Nachrichten signiert und Signaturen verifiziert</p>
                    </div>
                    <div class="interactive-box">
                        <h4>üéØ Praktische Anwendung</h4>
                        <p>Selbstst√§ndiges Erstellen und Pr√ºfen von digitalen Signaturen</p>
                    </div>
                </div>

                <h3>üó∫Ô∏è Dein Lernweg</h3>
                <div class="step">
                    <span class="step-number">1</span>
                    <strong>RSA Grundlagen:</strong> Wiederhole die Funktionsweise von RSA und asymmetrischer Verschl√ºsselung
                </div>
                <div class="step">
                    <span class="step-number">2</span>
                    <strong>RSA √úbung:</strong> Berechne selbst ein RSA-Schl√ºsselpaar und verschl√ºssele die Nachricht "HI"
                </div>
                <div class="step">
                    <span class="step-number">3</span>
                    <strong>Hash-Funktionen:</strong> Lerne, wie Hash-Funktionen funktionieren und probiere verschiedene Algorithmen aus
                </div>
                <div class="step">
                    <span class="step-number">4</span>
                    <strong>Digitale Signatur:</strong> Verstehe das Prinzip der digitalen Signatur und wie sie Authentizit√§t garantiert
                </div>
                <div class="step">
                    <span class="step-number">5</span>
                    <strong>Praxis-Labor:</strong> Wende alles Gelernte in einem interaktiven Labor an
                </div>

                <div class="warning-box">
                    <h3>üí° Tipp</h3>
                    <p>Du kannst jederzeit zwischen den Abschnitten wechseln. Nutze die Navigation oben, um zu einem bestimmten Thema zur√ºckzukehren!</p>
                </div>
            </div>

            <!-- RSA BASICS SECTION -->
            <div id="rsa-basics" class="section">
                <h2>üîë RSA Grundlagen</h2>
                
                <div class="info-box">
                    <h3>Was ist RSA?</h3>
                    <p>RSA ist ein asymmetrisches Verschl√ºsselungsverfahren, das auf der Schwierigkeit basiert, gro√üe Zahlen zu faktorisieren. Es verwendet ein Schl√ºsselpaar: einen √∂ffentlichen Schl√ºssel zum Verschl√ºsseln und einen privaten Schl√ºssel zum Entschl√ºsseln.</p>
                </div>

                <h3>üîê Das Schl√ºsselpaar</h3>
                <div class="grid-2">
                    <div class="interactive-box">
                        <h4>üîì √ñffentlicher Schl√ºssel (Public Key)</h4>
                        <p><strong>Besteht aus:</strong> (e, n)</p>
                        <ul>
                            <li>Wird √∂ffentlich geteilt</li>
                            <li>Dient zum Verschl√ºsseln von Nachrichten</li>
                            <li>Kann von jedem verwendet werden</li>
                        </ul>
                    </div>
                    <div class="interactive-box">
                        <h4>üîí Privater Schl√ºssel (Private Key)</h4>
                        <p><strong>Besteht aus:</strong> (d, n)</p>
                        <ul>
                            <li>Wird geheim gehalten</li>
                            <li>Dient zum Entschl√ºsseln von Nachrichten</li>
                            <li>Nur der Besitzer kennt ihn</li>
                        </ul>
                    </div>
                </div>

                <h3>üìê Schl√ºsselerstellung - Die Schritte</h3>
                
                <div class="step">
                    <span class="step-number">1</span>
                    <strong>W√§hle zwei Primzahlen p und q</strong>
                    <div class="formula">
                        Beispiel: p = 5, q = 17
                    </div>
                </div>

                <div class="step">
                    <span class="step-number">2</span>
                    <strong>Berechne n = p √ó q</strong>
                    <div class="formula">
                        n = 5 √ó 17 = 85
                    </div>
                    <p>n ist Teil beider Schl√ºssel und bestimmt die maximale Nachrichtengr√∂√üe</p>
                </div>

                <div class="step">
                    <span class="step-number">3</span>
                    <strong>Berechne œÜ(n) = (p-1) √ó (q-1)</strong>
                    <div class="formula">
                        œÜ(n) = (5-1) √ó (17-1) = 4 √ó 16 = 64
                    </div>
                    <p>œÜ(n) ist die Eulersche Phi-Funktion</p>
                </div>

                <div class="step">
                    <span class="step-number">4</span>
                    <strong>W√§hle e mit: 1 < e < œÜ(n) und ggT(e, œÜ(n)) = 1</strong>
                    <div class="formula">
                        Beispiel: e = 5
                        <br>ggT(5, 64) = 1 ‚úì
                    </div>
                    <p>e ist der √∂ffentliche Exponent</p>
                </div>

                <div class="step">
                    <span class="step-number">5</span>
                    <strong>Berechne d mit: d √ó e ‚â° 1 (mod œÜ(n))</strong>
                    <div class="formula">
                        d √ó 5 ‚â° 1 (mod 64)
                        <br>d = 77
                        <br>Probe: 77 √ó 5 = 385 = 6 √ó 64 + 1 ‚úì
                    </div>
                    <p>d ist der private Exponent</p>
                </div>

                <div class="success-box">
                    <h3>‚úÖ Ergebnis</h3>
                    <p><strong>√ñffentlicher Schl√ºssel:</strong> (e=5, n=85)</p>
                    <p><strong>Privater Schl√ºssel:</strong> (d=77, n=85)</p>
                </div>

                <h3>üîÑ Ver- und Entschl√ºsselung</h3>
                
                <div class="visual-diagram">
                    <div class="box">Klartext (m)</div>
                    <div class="arrow">‚Üì</div>
                    <div class="box">Verschl√ºsselung: c = m<sup>e</sup> mod n</div>
                    <div class="arrow">‚Üì</div>
                    <div class="box">Geheimtext (c)</div>
                    <div class="arrow">‚Üì</div>
                    <div class="box">Entschl√ºsselung: m = c<sup>d</sup> mod n</div>
                    <div class="arrow">‚Üì</div>
                    <div class="box">Klartext (m)</div>
                </div>

                <div class="info-box">
                    <h3>üîç Wichtig zu verstehen</h3>
                    <ul>
                        <li><strong>Mit dem √∂ffentlichen Schl√ºssel verschl√ºsselt</strong> ‚Üí nur mit dem privaten Schl√ºssel entschl√ºsselbar</li>
                        <li><strong>Mit dem privaten Schl√ºssel verschl√ºsselt</strong> ‚Üí mit dem √∂ffentlichen Schl√ºssel entschl√ºsselbar (Grundlage f√ºr Signaturen!)</li>
                        <li>Die Sicherheit beruht darauf, dass es sehr schwer ist, n in p und q zu zerlegen</li>
                    </ul>
                </div>
            </div>

            <!-- RSA PRACTICE SECTION -->
            <div id="rsa-practice" class="section">
                <h2>‚úèÔ∏è RSA √úbung: Verschl√ºssele "HI"</h2>
                
                <div class="info-box">
                    <h3>üéØ Deine Aufgabe</h3>
                    <p>Berechne Schritt f√ºr Schritt die RSA-Schl√ºssel f√ºr p=5 und q=17 und verschl√ºssele dann die Nachricht "HI".</p>
                </div>

                <h3>üìä ASCII-Tabelle (Auszug)</h3>
                <table>
                    <tr>
                        <th>Zeichen</th>
                        <th>ASCII-Wert (dezimal)</th>
                    </tr>
                    <tr><td>H</td><td>72</td></tr>
                    <tr><td>I</td><td>73</td></tr>
                    <tr><td>Leerzeichen</td><td>32</td></tr>
                    <tr><td>A</td><td>65</td></tr>
                    <tr><td>B</td><td>66</td></tr>
                </table>

                <h3>Schritt 1: Berechne n</h3>
                <div class="interactive-box">
                    <p>Gegeben: p = 5, q = 17</p>
                    <label for="calc-n">Berechne n = p √ó q:</label>
                    <input type="number" id="calc-n" placeholder="Deine Antwort">
                    <button onclick="checkN()">Pr√ºfen</button>
                    <div id="result-n"></div>
                </div>

                <h3>Schritt 2: Berechne œÜ(n)</h3>
                <div class="interactive-box">
                    <label for="calc-phi">Berechne œÜ(n) = (p-1) √ó (q-1):</label>
                    <input type="number" id="calc-phi" placeholder="Deine Antwort">
                    <button onclick="checkPhi()">Pr√ºfen</button>
                    <div id="result-phi"></div>
                    
                    <div class="info-box" style="margin-top: 20px;">
                        <h4>üí° Hilfe: Was ist œÜ(n)?</h4>
                        <p>Die Eulersche Phi-Funktion œÜ(n) gibt an, wie viele Zahlen zwischen 1 und n existieren, die zu n teilerfremd sind.</p>
                        <p>F√ºr zwei Primzahlen p und q gilt: œÜ(p√óq) = (p-1) √ó (q-1)</p>
                    </div>
                </div>

                <h3>Schritt 3: W√§hle e</h3>
                <div class="interactive-box">
                    <p>e muss teilerfremd zu œÜ(n) sein: ggT(e, œÜ(n)) = 1</p>
                    <label for="calc-e">W√§hle einen passenden Wert f√ºr e (zwischen 2 und œÜ(n)-1):</label>
                    <input type="number" id="calc-e" placeholder="Deine Antwort">
                    <button onclick="checkE()">Pr√ºfen</button>
                    <div id="result-e"></div>
                    
                    <div class="info-box" style="margin-top: 20px;">
                        <h4>üí° Tipp</h4>
                        <p>H√§ufig verwendete Werte f√ºr e sind: 3, 5, 17, 257, 65537</p>
                        <p>Probiere e = 5 aus!</p>
                    </div>
                </div>

                <h3>Schritt 4: Berechne d</h3>
                <div class="interactive-box">
                    <p>d ist das multiplikative Inverse von e modulo œÜ(n)</p>
                    <p>Das bedeutet: d √ó e ‚â° 1 (mod œÜ(n))</p>
                    <label for="calc-d">Berechne d (f√ºr e=5 und œÜ(n)=64):</label>
                    <input type="number" id="calc-d" placeholder="Deine Antwort">
                    <button onclick="checkD()">Pr√ºfen</button>
                    <div id="result-d"></div>
                    
                    <div class="info-box" style="margin-top: 20px;">
                        <h4>üí° Hilfe: Wie finde ich d?</h4>
                        <p>Suche eine Zahl d, sodass (d √ó e) mod œÜ(n) = 1</p>
                        <p>F√ºr e=5 und œÜ(n)=64: Probiere Vielfache von 64 plus 1, geteilt durch 5</p>
                        <p>Beispiel: (64 + 1) √∑ 5 = 13 (geht nicht auf)</p>
                        <p>Beispiel: (128 + 1) √∑ 5 = 25,8 (geht nicht auf)</p>
                        <p>Beispiel: (384 + 1) √∑ 5 = 77 ‚úì</p>
                    </div>
                </div>

                <div id="keys-summary" style="display:none;">
                    <div class="success-box">
                        <h3>‚úÖ Deine Schl√ºssel</h3>
                        <p><strong>√ñffentlicher Schl√ºssel:</strong> (e=<span id="display-e"></span>, n=<span id="display-n"></span>)</p>
                        <p><strong>Privater Schl√ºssel:</strong> (d=<span id="display-d"></span>, n=<span id="display-n2"></span>)</p>
                    </div>
                </div>

                <h3>Schritt 5: Verschl√ºssele "HI"</h3>
                <div class="interactive-box">
                    <h4>Verschl√ºsselung von 'H' (ASCII: 72)</h4>
                    <p>Formel: c = m<sup>e</sup> mod n = 72<sup>5</sup> mod 85</p>
                    <label for="encrypt-h">Berechne den Geheimtext f√ºr 'H':</label>
                    <input type="number" id="encrypt-h" placeholder="Deine Antwort">
                    <button onclick="checkEncryptH()">Pr√ºfen</button>
                    <div id="result-encrypt-h"></div>
                    
                    <div class="info-box" style="margin-top: 20px;">
                        <h4>üí° Rechenhilfe</h4>
                        <p>72<sup>5</sup> = 72 √ó 72 √ó 72 √ó 72 √ó 72 = 1.934.917.632</p>
                        <p>1.934.917.632 mod 85 = ?</p>
                        <p>Tipp: 1.934.917.632 √∑ 85 = 22.763.736 Rest 72</p>
                    </div>
                </div>

                <div class="interactive-box">
                    <h4>Verschl√ºsselung von 'I' (ASCII: 73)</h4>
                    <p>Formel: c = m<sup>e</sup> mod n = 73<sup>5</sup> mod 85</p>
                    <label for="encrypt-i">Berechne den Geheimtext f√ºr 'I':</label>
                    <input type="number" id="encrypt-i" placeholder="Deine Antwort">
                    <button onclick="checkEncryptI()">Pr√ºfen</button>
                    <div id="result-encrypt-i"></div>
                </div>

                <div id="encryption-summary" style="display:none;">
                    <div class="success-box">
                        <h3>üéâ Gl√ºckwunsch!</h3>
                        <p><strong>Klartext:</strong> HI (ASCII: 72, 73)</p>
                        <p><strong>Geheimtext:</strong> <span id="cipher-h"></span>, <span id="cipher-i"></span></p>
                        <p>Du hast erfolgreich mit RSA verschl√ºsselt!</p>
                    </div>
                    
                    <h4>üîì Entschl√ºsselung (zur Kontrolle)</h4>
                    <div class="formula">
                        m = c<sup>d</sup> mod n
                        <br>72 = <span id="cipher-h2"></span><sup>77</sup> mod 85
                        <br>73 = <span id="cipher-i2"></span><sup>77</sup> mod 85
                    </div>
                </div>

                <div class="warning-box">
                    <h3>‚ö†Ô∏è Wichtig f√ºr digitale Signaturen</h3>
                    <p>Was du gerade gelernt hast, ist die Grundlage f√ºr digitale Signaturen:</p>
                    <ul>
                        <li>Normale Verschl√ºsselung: Mit <strong>√∂ffentlichem Schl√ºssel</strong> verschl√ºsseln ‚Üí mit <strong>privatem Schl√ºssel</strong> entschl√ºsseln</li>
                        <li>Digitale Signatur: Mit <strong>privatem Schl√ºssel</strong> "verschl√ºsseln" ‚Üí mit <strong>√∂ffentlichem Schl√ºssel</strong> "entschl√ºsseln"</li>
                    </ul>
                    <p>Dadurch kann jeder pr√ºfen, dass die Nachricht wirklich vom Besitzer des privaten Schl√ºssels stammt!</p>
                </div>
            </div>

            <!-- HASH SECTION -->
            <div id="hash" class="section">
                <h2># Hash-Funktionen</h2>
                
                <div class="info-box">
                    <h3>Was ist eine Hash-Funktion?</h3>
                    <p>Eine Hash-Funktion ist eine mathematische Funktion, die aus einer beliebig langen Eingabe (z.B. einer Nachricht) eine Ausgabe fester L√§nge erzeugt ‚Äì den <strong>Hash-Wert</strong> oder <strong>Fingerabdruck</strong>.</p>
                </div>

                <h3>üéØ Eigenschaften einer kryptographischen Hash-Funktion</h3>
                <div class="grid-2">
                    <div class="interactive-box">
                        <h4>‚ö° Schnell berechenbar</h4>
                        <p>Der Hash-Wert kann schnell aus der Eingabe berechnet werden</p>
                    </div>
                    <div class="interactive-box">
                        <h4>üîí Einwegfunktion</h4>
                        <p>Aus dem Hash-Wert kann nicht auf die urspr√ºngliche Eingabe geschlossen werden</p>
                    </div>
                    <div class="interactive-box">
                        <h4>üé≤ Deterministisch</h4>
                        <p>Die gleiche Eingabe erzeugt immer den gleichen Hash-Wert</p>
                    </div>
                    <div class="interactive-box">
                        <h4>ü¶ã Lawineneffekt</h4>
                        <p>Eine kleine √Ñnderung der Eingabe ver√§ndert den Hash-Wert komplett</p>
                    </div>
                    <div class="interactive-box">
                        <h4>üö´ Kollisionsresistent</h4>
                        <p>Es ist praktisch unm√∂glich, zwei verschiedene Eingaben mit gleichem Hash-Wert zu finden</p>
                    </div>
                    <div class="interactive-box">
                        <h4>üìè Feste L√§nge</h4>
                        <p>Der Hash-Wert hat immer die gleiche L√§nge, unabh√§ngig von der Eingabel√§nge</p>
                    </div>
                </div>

                <h3>üî¨ Probiere es aus!</h3>
                <div class="interactive-box">
                    <label for="hash-input">Gib einen Text ein:</label>
                    <input type="text" id="hash-input" placeholder="z.B. Hallo Welt" value="Hallo Welt">
                    
                    <h4>W√§hle eine Hash-Funktion:</h4>
                    <div>
                        <span class="hash-option selected" onclick="selectHash('simple')" id="hash-simple">Simple Hash</span>
                        <span class="hash-option" onclick="selectHash('md5')" id="hash-md5">MD5 (Demo)</span>
                        <span class="hash-option" onclick="selectHash('sha256')" id="hash-sha256">SHA-256 (simuliert)</span>
                    </div>
                    
                    <button onclick="calculateHash()" style="margin-top: 20px;">Hash berechnen</button>
                    
                    <div id="hash-result" style="margin-top: 20px;"></div>
                </div>

                <h3>ü¶ã Der Lawineneffekt</h3>
                <div class="interactive-box">
                    <p>√Ñndere nur ein einziges Zeichen und beobachte, wie sich der Hash-Wert komplett ver√§ndert!</p>
                    
                    <label>Originaltext:</label>
                    <input type="text" id="avalanche-1" value="Hallo Welt" oninput="demonstrateAvalanche()">
                    <div class="key-display" id="avalanche-hash-1"></div>
                    
                    <label>Ge√§nderter Text:</label>
                    <input type="text" id="avalanche-2" value="Hallo Welt!" oninput="demonstrateAvalanche()">
                    <div class="key-display" id="avalanche-hash-2"></div>
                    
                    <div id="avalanche-comparison"></div>
                </div>

                <h3>üìö G√§ngige Hash-Algorithmen</h3>
                <table>
                    <tr>
                        <th>Algorithmus</th>
                        <th>Hash-L√§nge</th>
                        <th>Status</th>
                        <th>Verwendung</th>
                    </tr>
                    <tr>
                        <td><strong>MD5</strong></td>
                        <td>128 Bit (32 Hex-Zeichen)</td>
                        <td>‚ö†Ô∏è Unsicher</td>
                        <td>Nur f√ºr Pr√ºfsummen, nicht f√ºr Sicherheit</td>
                    </tr>
                    <tr>
                        <td><strong>SHA-1</strong></td>
                        <td>160 Bit (40 Hex-Zeichen)</td>
                        <td>‚ö†Ô∏è Veraltet</td>
                        <td>Wird nicht mehr empfohlen</td>
                    </tr>
                    <tr>
                        <td><strong>SHA-256</strong></td>
                        <td>256 Bit (64 Hex-Zeichen)</td>
                        <td>‚úÖ Sicher</td>
                        <td>Bitcoin, TLS, digitale Signaturen</td>
                    </tr>
                    <tr>
                        <td><strong>SHA-512</strong></td>
                        <td>512 Bit (128 Hex-Zeichen)</td>
                        <td>‚úÖ Sehr sicher</td>
                        <td>Hochsichere Anwendungen</td>
                    </tr>
                </table>

                <h3>üí° Anwendungen von Hash-Funktionen</h3>
                <div class="step">
                    <span class="step-number">1</span>
                    <strong>Passwort-Speicherung</strong>
                    <p>Passw√∂rter werden nicht im Klartext gespeichert, sondern nur ihr Hash-Wert</p>
                </div>
                <div class="step">
                    <span class="step-number">2</span>
                    <strong>Datenintegrit√§t</strong>
                    <p>Pr√ºfung, ob Dateien bei der √úbertragung ver√§ndert wurden</p>
                </div>
                <div class="step">
                    <span class="step-number">3</span>
                    <strong>Digitale Signaturen</strong>
                    <p>Statt die ganze Nachricht zu signieren, wird nur der Hash-Wert signiert (effizienter!)</p>
                </div>
                <div class="step">
                    <span class="step-number">4</span>
                    <strong>Blockchain</strong>
                    <p>Verkettung von Bl√∂cken durch Hash-Werte (z.B. Bitcoin)</p>
                </div>

                <div class="warning-box">
                    <h3>üîó Verbindung zur digitalen Signatur</h3>
                    <p>Bei digitalen Signaturen wird nicht die gesamte Nachricht mit dem privaten Schl√ºssel verschl√ºsselt, sondern nur der <strong>Hash-Wert</strong> der Nachricht!</p>
                    <p><strong>Warum?</strong></p>
                    <ul>
                        <li>‚úÖ Viel effizienter (Hash ist immer gleich lang, egal wie lang die Nachricht ist)</li>
                        <li>‚úÖ Schneller zu berechnen</li>
                        <li>‚úÖ Gleiche Sicherheit</li>
                    </ul>
                </div>
            </div>

            <!-- SIGNATURE SECTION -->
            <div id="signature" class="section">
                <h2>‚úçÔ∏è Digitale Signatur</h2>
                
                <div class="info-box">
                    <h3>Was ist eine digitale Signatur?</h3>
                    <p>Eine digitale Signatur ist das elektronische √Ñquivalent zu einer handschriftlichen Unterschrift. Sie beweist:</p>
                    <ul>
                        <li><strong>Authentizit√§t:</strong> Die Nachricht stammt wirklich vom angegebenen Absender</li>
                        <li><strong>Integrit√§t:</strong> Die Nachricht wurde nicht ver√§ndert</li>
                        <li><strong>Nicht-Abstreitbarkeit:</strong> Der Absender kann nicht leugnen, die Nachricht gesendet zu haben</li>
                    </ul>
                </div>

                <h3>üîÑ Wie funktioniert eine digitale Signatur?</h3>
                
                <div class="visual-diagram">
                    <h4>üì§ Signieren (Sender)</h4>
                    <div class="box">Nachricht</div>
                    <div class="arrow">‚Üì</div>
                    <div class="box">Hash-Funktion</div>
                    <div class="arrow">‚Üì</div>
                    <div class="box">Hash-Wert</div>
                    <div class="arrow">‚Üì</div>
                    <div class="box">Verschl√ºsselung mit privatem Schl√ºssel</div>
                    <div class="arrow">‚Üì</div>
                    <div class="box">Digitale Signatur</div>
                    <div style="margin-top: 20px;">
                        <p>‚Üí Sende: <strong>Nachricht</strong> + <strong>Signatur</strong></p>
                    </div>
                </div>

                <div class="visual-diagram" style="margin-top: 30px;">
                    <h4>üì• Verifizieren (Empf√§nger)</h4>
                    <div class="box">Empfangene Nachricht</div>
                    <div class="arrow">‚Üì</div>
                    <div class="box">Hash-Funktion</div>
                    <div class="arrow">‚Üì</div>
                    <div class="box">Hash-Wert A</div>
                    
                    <div style="margin: 20px 0; font-size: 1.5em;">‚öñÔ∏è Vergleich</div>
                    
                    <div class="box">Empfangene Signatur</div>
                    <div class="arrow">‚Üì</div>
                    <div class="box">Entschl√ºsselung mit √∂ffentlichem Schl√ºssel</div>
                    <div class="arrow">‚Üì</div>
                    <div class="box">Hash-Wert B</div>
                    
                    <div style="margin-top: 20px;">
                        <p><strong>Hash-Wert A = Hash-Wert B?</strong></p>
                        <p>‚úÖ Ja ‚Üí Signatur g√ºltig</p>
                        <p>‚ùå Nein ‚Üí Signatur ung√ºltig</p>
                    </div>
                </div>

                <h3>üéØ Schritt-f√ºr-Schritt Anleitung</h3>
                
                <div class="step">
                    <span class="step-number">1</span>
                    <strong>Sender erstellt Schl√ºsselpaar</strong>
                    <p>Alice generiert ein RSA-Schl√ºsselpaar: (e, n) √∂ffentlich und (d, n) privat</p>
                </div>

                <div class="step">
                    <span class="step-number">2</span>
                    <strong>Sender teilt √∂ffentlichen Schl√ºssel</strong>
                    <p>Alice ver√∂ffentlicht ihren √∂ffentlichen Schl√ºssel (e, n), damit andere ihre Signaturen pr√ºfen k√∂nnen</p>
                </div>

                <div class="step">
                    <span class="step-number">3</span>
                    <strong>Sender erstellt Hash der Nachricht</strong>
                    <p>Alice berechnet: hash = SHA-256("Hallo Bob")</p>
                </div>

                <div class="step">
                    <span class="step-number">4</span>
                    <strong>Sender signiert den Hash</strong>
                    <p>Alice verschl√ºsselt den Hash mit ihrem privaten Schl√ºssel: signatur = hash<sup>d</sup> mod n</p>
                </div>

                <div class="step">
                    <span class="step-number">5</span>
                    <strong>Sender sendet Nachricht + Signatur</strong>
                    <p>Alice sendet an Bob: "Hallo Bob" + signatur</p>
                </div>

                <div class="step">
                    <span class="step-number">6</span>
                    <strong>Empf√§nger berechnet Hash der Nachricht</strong>
                    <p>Bob berechnet: hash_empfangen = SHA-256("Hallo Bob")</p>
                </div>

                <div class="step">
                    <span class="step-number">7</span>
                    <strong>Empf√§nger entschl√ºsselt die Signatur</strong>
                    <p>Bob entschl√ºsselt mit Alices √∂ffentlichem Schl√ºssel: hash_signatur = signatur<sup>e</sup> mod n</p>
                </div>

                <div class="step">
                    <span class="step-number">8</span>
                    <strong>Empf√§nger vergleicht Hash-Werte</strong>
                    <p>Bob pr√ºft: hash_empfangen == hash_signatur?</p>
                    <p>‚úÖ Gleich ‚Üí Signatur g√ºltig, Nachricht authentisch und unver√§ndert</p>
                    <p>‚ùå Unterschiedlich ‚Üí Signatur ung√ºltig, Nachricht wurde ver√§ndert oder stammt nicht von Alice</p>
                </div>

                <h3>üîê Warum ist das sicher?</h3>
                <div class="grid-2">
                    <div class="interactive-box">
                        <h4>üîí Nur der Besitzer des privaten Schl√ºssels kann signieren</h4>
                        <p>Da nur Alice ihren privaten Schl√ºssel kennt, kann nur sie g√ºltige Signaturen erstellen</p>
                    </div>
                    <div class="interactive-box">
                        <h4>üîì Jeder kann die Signatur pr√ºfen</h4>
                        <p>Mit Alices √∂ffentlichem Schl√ºssel kann jeder die Echtheit der Signatur verifizieren</p>
                    </div>
                    <div class="interactive-box">
                        <h4>üîó Hash bindet Signatur an Nachricht</h4>
                        <p>Die Signatur ist nur f√ºr diese spezifische Nachricht g√ºltig. √Ñnderungen werden sofort erkannt</p>
                    </div>
                    <div class="interactive-box">
                        <h4>‚ö° Effizienz durch Hash</h4>
                        <p>Statt die ganze Nachricht zu verschl√ºsseln, wird nur der kurze Hash-Wert verschl√ºsselt</p>
                    </div>
                </div>

                <h3>‚ùå Was passiert bei Manipulation?</h3>
                <div class="interactive-box">
                    <h4>Szenario 1: Nachricht wird ver√§ndert</h4>
                    <div class="formula">
                        Original: "√úberweise 100‚Ç¨" ‚Üí Hash A ‚Üí Signatur
                        <br>Manipuliert: "√úberweise 1000‚Ç¨" ‚Üí Hash B ‚Üí Hash B ‚â† Hash A
                        <br>‚ùå Signatur ung√ºltig!
                    </div>
                </div>

                <div class="interactive-box">
                    <h4>Szenario 2: Angreifer versucht neue Signatur zu erstellen</h4>
                    <div class="formula">
                        Angreifer hat nicht den privaten Schl√ºssel
                        <br>‚Üí Kann keine g√ºltige Signatur erstellen
                        <br>‚ùå F√§lschung wird erkannt!
                    </div>
                </div>

                <h3>üÜö Unterschied: Verschl√ºsselung vs. Signatur</h3>
                <table>
                    <tr>
                        <th>Aspekt</th>
                        <th>Verschl√ºsselung</th>
                        <th>Digitale Signatur</th>
                    </tr>
                    <tr>
                        <td><strong>Ziel</strong></td>
                        <td>Vertraulichkeit</td>
                        <td>Authentizit√§t & Integrit√§t</td>
                    </tr>
                    <tr>
                        <td><strong>Verschl√ºsseln mit</strong></td>
                        <td>√ñffentlichem Schl√ºssel des Empf√§ngers</td>
                        <td>Privatem Schl√ºssel des Senders</td>
                    </tr>
                    <tr>
                        <td><strong>Entschl√ºsseln mit</strong></td>
                        <td>Privatem Schl√ºssel des Empf√§ngers</td>
                        <td>√ñffentlichem Schl√ºssel des Senders</td>
                    </tr>
                    <tr>
                        <td><strong>Was wird gesch√ºtzt?</strong></td>
                        <td>Inhalt vor unbefugtem Lesen</td>
                        <td>Herkunft und Unversehrtheit</td>
                    </tr>
                </table>

                <div class="success-box">
                    <h3>üí° Merke dir</h3>
                    <p><strong>Verschl√ºsselung:</strong> "Ich will, dass nur DU es lesen kannst" ‚Üí Verschl√ºssele mit DEINEM √∂ffentlichen Schl√ºssel</p>
                    <p><strong>Signatur:</strong> "Ich will beweisen, dass ICH es geschrieben habe" ‚Üí Signiere mit MEINEM privaten Schl√ºssel</p>
                </div>

                <div class="warning-box">
                    <h3>üîê Kombination: Verschl√ºsselung + Signatur</h3>
                    <p>In der Praxis werden oft beide Verfahren kombiniert:</p>
                    <ol>
                        <li>Alice signiert die Nachricht mit ihrem privaten Schl√ºssel</li>
                        <li>Alice verschl√ºsselt Nachricht + Signatur mit Bobs √∂ffentlichem Schl√ºssel</li>
                        <li>Bob entschl√ºsselt mit seinem privaten Schl√ºssel</li>
                        <li>Bob verifiziert die Signatur mit Alices √∂ffentlichem Schl√ºssel</li>
                    </ol>
                    <p>‚Üí Vertraulichkeit + Authentizit√§t + Integrit√§t ‚úÖ</p>
                </div>
            </div>

            <!-- PRACTICE LAB SECTION -->
            <div id="practice" class="section">
                <h2>üéØ Praxis-Labor: Digitale Signatur</h2>
                
                <div class="info-box">
                    <h3>üéì Deine Aufgabe</h3>
                    <p>Simuliere eine sichere Kommunikation mit digitalen Signaturen. Du kannst Schl√ºssel generieren, Nachrichten signieren und Signaturen verifizieren.</p>
                </div>

                <div class="tabs">
                    <button class="tab active" onclick="showTab('tab-keys')">üîë Schl√ºssel</button>
                    <button class="tab" onclick="showTab('tab-sign')">‚úçÔ∏è Signieren</button>
                    <button class="tab" onclick="showTab('tab-verify')">‚úÖ Verifizieren</button>
                    <button class="tab" onclick="showTab('tab-complete')">üéØ Vollst√§ndige Kommunikation</button>
                </div>

                <!-- TAB: Keys -->
                <div id="tab-keys" class="tab-content active">
                    <h3>üîë Schl√ºsselverwaltung</h3>
                    
                    <div class="grid-2">
                        <div class="interactive-box">
                            <h4>üë§ Person A (z.B. Alice)</h4>
                            <button onclick="generateKeysA()">Schl√ºsselpaar generieren</button>
                            
                            <label>√ñffentlicher Schl√ºssel A:</label>
                            <div class="key-display" id="public-key-a">Noch nicht generiert</div>
                            <button class="copy-btn btn-secondary" onclick="copyKey('public-key-a')">üìã Kopieren</button>
                            
                            <label>Privater Schl√ºssel A:</label>
                            <div class="key-display" id="private-key-a">Noch nicht generiert</div>
                            <button class="copy-btn btn-secondary" onclick="copyKey('private-key-a')">üìã Kopieren</button>
                        </div>

                        <div class="interactive-box">
                            <h4>üë§ Person B (z.B. Bob)</h4>
                            <button onclick="generateKeysB()">Schl√ºsselpaar generieren</button>
                            
                            <label>√ñffentlicher Schl√ºssel B:</label>
                            <div class="key-display" id="public-key-b">Noch nicht generiert</div>
                            <button class="copy-btn btn-secondary" onclick="copyKey('public-key-b')">üìã Kopieren</button>
                            
                            <label>Privater Schl√ºssel B:</label>
                            <div class="key-display" id="private-key-b">Noch nicht generiert</div>
                            <button class="copy-btn btn-secondary" onclick="copyKey('private-key-b')">üìã Kopieren</button>
                        </div>
                    </div>

                    <div class="info-box">
                        <h4>üí° Hinweis</h4>
                        <p>In der Realit√§t w√ºrden die Schl√ºssel viel l√§nger sein (2048 oder 4096 Bit). Hier verwenden wir k√ºrzere Schl√ºssel f√ºr Demonstrationszwecke.</p>
                    </div>
                </div>

                <!-- TAB: Sign -->
                <div id="tab-sign" class="tab-content">
                    <h3>‚úçÔ∏è Nachricht signieren</h3>
                    
                    <div class="interactive-box">
                        <label>W√§hle Hash-Funktion:</label>
                        <div>
                            <span class="hash-option selected" onclick="selectSignHash('simple')" id="sign-hash-simple">Simple Hash</span>
                            <span class="hash-option" onclick="selectSignHash('md5')" id="sign-hash-md5">MD5 (Demo)</span>
                            <span class="hash-option" onclick="selectSignHash('sha256')" id="sign-hash-sha256">SHA-256 (simuliert)</span>
                        </div>

                        <label>Deine Nachricht:</label>
                        <textarea id="sign-message" rows="4" placeholder="Gib deine Nachricht ein...">Hallo, dies ist eine wichtige Nachricht!</textarea>

                        <label>Dein privater Schl√ºssel:</label>
                        <textarea id="sign-private-key" rows="2" placeholder="F√ºge deinen privaten Schl√ºssel ein..."></textarea>

                        <button onclick="signMessage()">Nachricht signieren</button>

                        <div id="sign-result"></div>
                    </div>

                    <div class="info-box">
                        <h4>üìã Ablauf</h4>
                        <ol>
                            <li>W√§hle eine Hash-Funktion</li>
                            <li>Schreibe deine Nachricht</li>
                            <li>F√ºge deinen privaten Schl√ºssel ein (aus dem Schl√ºssel-Tab)</li>
                            <li>Klicke auf "Nachricht signieren"</li>
                            <li>Kopiere die Signatur und sende sie zusammen mit der Nachricht</li>
                        </ol>
                    </div>
                </div>

                <!-- TAB: Verify -->
                <div id="tab-verify" class="tab-content">
                    <h3>‚úÖ Signatur verifizieren</h3>
                    
                    <div class="interactive-box">
                        <label>W√§hle Hash-Funktion (muss die gleiche sein wie beim Signieren!):</label>
                        <div>
                            <span class="hash-option selected" onclick="selectVerifyHash('simple')" id="verify-hash-simple">Simple Hash</span>
                            <span class="hash-option" onclick="selectVerifyHash('md5')" id="verify-hash-md5">MD5 (Demo)</span>
                            <span class="hash-option" onclick="selectVerifyHash('sha256')" id="verify-hash-sha256">SHA-256 (simuliert)</span>
                        </div>

                        <label>Empfangene Nachricht:</label>
                        <textarea id="verify-message" rows="4" placeholder="F√ºge die empfangene Nachricht ein..."></textarea>

                        <label>Empfangene Signatur:</label>
                        <textarea id="verify-signature" rows="2" placeholder="F√ºge die empfangene Signatur ein..."></textarea>

                        <label>√ñffentlicher Schl√ºssel des Senders:</label>
                        <textarea id="verify-public-key" rows="2" placeholder="F√ºge den √∂ffentlichen Schl√ºssel des Senders ein..."></textarea>

                        <button onclick="verifySignature()">Signatur verifizieren</button>

                        <div id="verify-result"></div>
                    </div>

                    <div class="warning-box">
                        <h4>üß™ Experimentiere!</h4>
                        <p>Versuche Folgendes:</p>
                        <ul>
                            <li>√Ñndere ein Zeichen in der Nachricht ‚Üí Signatur wird ung√ºltig</li>
                            <li>Verwende einen falschen √∂ffentlichen Schl√ºssel ‚Üí Signatur wird ung√ºltig</li>
                            <li>Verwende eine andere Hash-Funktion ‚Üí Signatur wird ung√ºltig</li>
                        </ul>
                    </div>
                </div>

                <!-- TAB: Complete Communication -->
                <div id="tab-complete" class="tab-content">
                    <h3>üéØ Vollst√§ndige Kommunikation</h3>
                    
                    <div class="info-box">
                        <h4>üì¨ Szenario</h4>
                        <p>Simuliere eine vollst√§ndige Kommunikation zwischen zwei Personen mit digitalen Signaturen.</p>
                    </div>

                    <div class="grid-2">
                        <!-- Sender Side -->
                        <div class="interactive-box">
                            <h4>üì§ Sender (Alice)</h4>
                            
                            <label>Hash-Funktion:</label>
                            <div>
                                <span class="hash-option selected" onclick="selectCompleteHash('simple')" id="complete-hash-simple">Simple</span>
                                <span class="hash-option" onclick="selectCompleteHash('md5')" id="complete-hash-md5">MD5</span>
                                <span class="hash-option" onclick="selectCompleteHash('sha256')" id="complete-hash-sha256">SHA-256</span>
                            </div>

                            <label>Meine Nachricht:</label>
                            <textarea id="complete-message" rows="4" placeholder="Schreibe deine Nachricht...">Treffen um 15 Uhr im Caf√©!</textarea>

                            <label>Mein privater Schl√ºssel:</label>
                            <input type="text" id="complete-my-private" placeholder="Privater Schl√ºssel">
                            <button class="btn-secondary" onclick="useKeyA('private')">Schl√ºssel A verwenden</button>

                            <label>√ñffentlicher Schl√ºssel des Empf√§ngers (f√ºr Verschl√ºsselung):</label>
                            <input type="text" id="complete-receiver-public" placeholder="√ñffentlicher Schl√ºssel des Empf√§ngers">
                            <button class="btn-secondary" onclick="useKeyB('public')">Schl√ºssel B verwenden</button>

                            <button onclick="sendCompleteMessage()" class="btn-success">üì§ Signieren & Verschl√ºsseln</button>

                            <div id="complete-send-result"></div>
                        </div>

                        <!-- Receiver Side -->
                        <div class="interactive-box">
                            <h4>üì• Empf√§nger (Bob)</h4>
                            
                            <label>Empfangene verschl√ºsselte Nachricht:</label>
                            <textarea id="complete-encrypted" rows="4" placeholder="Wird automatisch gef√ºllt..." readonly></textarea>

                            <label>Empfangene Signatur:</label>
                            <input type="text" id="complete-received-signature" placeholder="Wird automatisch gef√ºllt..." readonly>

                            <label>Mein privater Schl√ºssel (zum Entschl√ºsseln):</label>
                            <input type="text" id="complete-my-private-receive" placeholder="Privater Schl√ºssel">
                            <button class="btn-secondary" onclick="useKeyB('private-receive')">Schl√ºssel B verwenden</button>

                            <label>√ñffentlicher Schl√ºssel des Senders (zur Verifikation):</label>
                            <input type="text" id="complete-sender-public" placeholder="√ñffentlicher Schl√ºssel des Senders">
                            <button class="btn-secondary" onclick="useKeyA('public-receive')">Schl√ºssel A verwenden</button>

                            <button onclick="receiveCompleteMessage()" class="btn-success">üì• Entschl√ºsseln & Verifizieren</button>

                            <div id="complete-receive-result"></div>
                        </div>
                    </div>

                    <div class="success-box" style="margin-top: 30px;">
                        <h4>üéì Lernziel erreicht?</h4>
                        <p>Kannst du jetzt erkl√§ren:</p>
                        <ul>
                            <li>‚úÖ Wie eine digitale Signatur erstellt wird?</li>
                            <li>‚úÖ Warum Hash-Funktionen verwendet werden?</li>
                            <li>‚úÖ Wie die Verifikation funktioniert?</li>
                            <li>‚úÖ Was der Unterschied zwischen Verschl√ºsselung und Signatur ist?</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentSection = 'home';
        let currentHashAlgo = 'simple';
        let signHashAlgo = 'simple';
        let verifyHashAlgo = 'simple';
        let completeHashAlgo = 'simple';
        let keysA = null;
        let keysB = null;

        // Navigation
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById(sectionId).classList.add('active');
            event.target.classList.add('active');
            currentSection = sectionId;
        }

        // Tab navigation
        function showTab(tabId) {
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            event.target.classList.add('active');
            document.getElementById(tabId).classList.add('active');
        }

        // RSA Practice Functions
        function checkN() {
            const input = parseInt(document.getElementById('calc-n').value);
            const result = document.getElementById('result-n');
            
            if (input === 85) {
                result.innerHTML = '<div class="success-box">‚úÖ Richtig! n = 5 √ó 17 = 85</div>';
            } else {
                result.innerHTML = '<div class="error">‚ùå Nicht ganz. Multipliziere p und q: 5 √ó 17 = ?</div>';
            }
        }

        function checkPhi() {
            const input = parseInt(document.getElementById('calc-phi').value);
            const result = document.getElementById('result-phi');
            
            if (input === 64) {
                result.innerHTML = '<div class="success-box">‚úÖ Richtig! œÜ(n) = (5-1) √ó (17-1) = 4 √ó 16 = 64</div>';
            } else {
                result.innerHTML = '<div class="error">‚ùå Nicht ganz. Berechne (p-1) √ó (q-1) = (5-1) √ó (17-1) = ?</div>';
            }
        }

        function gcd(a, b) {
            while (b !== 0) {
                let temp = b;
                b = a % b;
                a = temp;
            }
            return a;
        }

        function checkE() {
            const input = parseInt(document.getElementById('calc-e').value);
            const result = document.getElementById('result-e');
            
            if (input < 2 || input >= 64) {
                result.innerHTML = '<div class="error">‚ùå e muss zwischen 2 und 63 liegen.</div>';
                return;
            }
            
            if (gcd(input, 64) === 1) {
                result.innerHTML = `<div class="success-box">‚úÖ Richtig! e = ${input} ist teilerfremd zu œÜ(n) = 64<br>ggT(${input}, 64) = 1</div>`;
            } else {
                result.innerHTML = `<div class="error">‚ùå e = ${input} ist nicht teilerfremd zu 64.<br>ggT(${input}, 64) = ${gcd(input, 64)} ‚â† 1<br>Versuche es mit e = 5</div>`;
            }
        }

        function checkD() {
            const input = parseInt(document.getElementById('calc-d').value);
            const result = document.getElementById('result-d');
            const e = 5;
            const phi = 64;
            
            if ((input * e) % phi === 1) {
                result.innerHTML = `<div class="success-box">‚úÖ Richtig! d = ${input}<br>Probe: ${input} √ó 5 = ${input * 5} ‚â° 1 (mod 64)</div>`;
                
                // Show keys summary
                document.getElementById('keys-summary').style.display = 'block';
                document.getElementById('display-e').textContent = e;
                document.getElementById('display-n').textContent = '85';
                document.getElementById('display-d').textContent = input;
                document.getElementById('display-n2').textContent = '85';
            } else {
                result.innerHTML = `<div class="error">‚ùå Nicht ganz. (${input} √ó 5) mod 64 = ${(input * 5) % 64} ‚â† 1<br>Tipp: d = 77</div>`;
            }
        }

        function modPow(base, exp, mod) {
            let result = 1;
            base = base % mod;
            while (exp > 0) {
                if (exp % 2 === 1) {
                    result = (result * base) % mod;
                }
                exp = Math.floor(exp / 2);
                base = (base * base) % mod;
            }
            return result;
        }

        function checkEncryptH() {
            const input = parseInt(document.getElementById('encrypt-h').value);
            const result = document.getElementById('result-encrypt-h');
            const correct = modPow(72, 5, 85);
            
            if (input === correct) {
                result.innerHTML = `<div class="success-box">‚úÖ Richtig! 72<sup>5</sup> mod 85 = ${correct}</div>`;
                document.getElementById('cipher-h').textContent = correct;
                document.getElementById('cipher-h2').textContent = correct;
            } else {
                result.innerHTML = `<div class="error">‚ùå Nicht ganz. Tipp: Das Ergebnis ist ${correct}</div>`;
            }
        }

        function checkEncryptI() {
            const input = parseInt(document.getElementById('encrypt-i').value);
            const result = document.getElementById('result-encrypt-i');
            const correct = modPow(73, 5, 85);
            
            if (input === correct) {
                result.innerHTML = `<div class="success-box">‚úÖ Richtig! 73<sup>5</sup> mod 85 = ${correct}</div>`;
                document.getElementById('cipher-i').textContent = correct;
                document.getElementById('cipher-i2').textContent = correct;
                document.getElementById('encryption-summary').style.display = 'block';
            } else {
                result.innerHTML = `<div class="error">‚ùå Nicht ganz. Tipp: Das Ergebnis ist ${correct}</div>`;
            }
        }

        // Hash Functions
        function simpleHash(str) {
            let hash = 0;
            for (let i = 0; i < str.length; i++) {
                const char = str.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash = hash & hash;
            }
            return Math.abs(hash).toString(16).padStart(8, '0');
        }

        function md5Demo(str) {
            // Simplified MD5-like hash for demo
            let hash = 0;
            for (let i = 0; i < str.length; i++) {
                hash = ((hash << 5) - hash) + str.charCodeAt(i);
                hash = hash & hash;
            }
            let result = '';
            for (let i = 0; i < 4; i++) {
                result += Math.abs(hash * (i + 1)).toString(16).padStart(8, '0');
            }
            return result.substring(0, 32);
        }

        function sha256Demo(str) {
            // Simplified SHA-256-like hash for demo
            let hash = 5381;
            for (let i = 0; i < str.length; i++) {
                hash = ((hash << 5) + hash) + str.charCodeAt(i);
            }
            let result = '';
            for (let i = 0; i < 8; i++) {
                result += Math.abs(hash * (i + 7)).toString(16).padStart(8, '0');
            }
            return result.substring(0, 64);
        }

        function getHash(str, algo) {
            switch(algo) {
                case 'simple': return simpleHash(str);
                case 'md5': return md5Demo(str);
                case 'sha256': return sha256Demo(str);
                default: return simpleHash(str);
            }
        }

        function selectHash(algo) {
            currentHashAlgo = algo;
            document.querySelectorAll('#hash .hash-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            document.getElementById('hash-' + algo).classList.add('selected');
        }

        function calculateHash() {
            const input = document.getElementById('hash-input').value;
            const hash = getHash(input, currentHashAlgo);
            const algoName = currentHashAlgo === 'simple' ? 'Simple Hash' : 
                           currentHashAlgo === 'md5' ? 'MD5 (Demo)' : 'SHA-256 (simuliert)';
            
            document.getElementById('hash-result').innerHTML = `
                <div class="success-box">
                    <h4>Hash-Wert (${algoName}):</h4>
                    <div class="key-display">${hash}</div>
                    <p><strong>L√§nge:</strong> ${hash.length} Zeichen</p>
                </div>
            `;
        }

        function demonstrateAvalanche() {
            const text1 = document.getElementById('avalanche-1').value;
            const text2 = document.getElementById('avalanche-2').value;
            
            const hash1 = getHash(text1, currentHashAlgo);
            const hash2 = getHash(text2, currentHashAlgo);
            
            document.getElementById('avalanche-hash-1').textContent = hash1;
            document.getElementById('avalanche-hash-2').textContent = hash2;
            
            let differences = 0;
            for (let i = 0; i < Math.min(hash1.length, hash2.length); i++) {
                if (hash1[i] !== hash2[i]) differences++;
            }
            
            const percentage = ((differences / hash1.length) * 100).toFixed(1);
            
            if (text1 === text2) {
                document.getElementById('avalanche-comparison').innerHTML = `
                    <div class="info-box">
                        ‚úÖ Identische Texte ‚Üí Identische Hash-Werte
                    </div>
                `;
            } else {
                document.getElementById('avalanche-comparison').innerHTML = `
                    <div class="warning-box">
                        ü¶ã <strong>Lawineneffekt:</strong> ${differences} von ${hash1.length} Zeichen unterschiedlich (${percentage}%)
                        <br>Selbst kleinste √Ñnderungen f√ºhren zu v√∂llig unterschiedlichen Hash-Werten!
                    </div>
                `;
            }
        }

        // Initialize avalanche demo
        setTimeout(() => {
            if (document.getElementById('avalanche-1')) {
                demonstrateAvalanche();
            }
        }, 100);

        // Key Generation (simplified RSA)
        function generateSimpleRSAKeys() {
            // Using small primes for demonstration
            const p = 61;
            const q = 53;
            const n = p * q; // 3233
            const phi = (p - 1) * (q - 1); // 3120
            const e = 17; // Common choice
            
            // Calculate d (simplified)
            let d = 1;
            while ((d * e) % phi !== 1) {
                d++;
            }
            
            return {
                publicKey: { e, n },
                privateKey: { d, n }
            };
        }

        function generateKeysA() {
            keysA = generateSimpleRSAKeys();
            document.getElementById('public-key-a').textContent = 
                `e: ${keysA.publicKey.e}, n: ${keysA.publicKey.n}`;
            document.getElementById('private-key-a').textContent = 
                `d: ${keysA.privateKey.d}, n: ${keysA.privateKey.n}`;
        }

        function generateKeysB() {
            keysB = generateSimpleRSAKeys();
            document.getElementById('public-key-b').textContent = 
                `e: ${keysB.publicKey.e}, n: ${keysB.publicKey.n}`;
            document.getElementById('private-key-b').textContent = 
                `d: ${keysB.privateKey.d}, n: ${keysB.privateKey.n}`;
        }

        function copyKey(elementId) {
            const text = document.getElementById(elementId).textContent;
            navigator.clipboard.writeText(text).then(() => {
                alert('Schl√ºssel kopiert!');
            });
        }

        // Signing
        function selectSignHash(algo) {
            signHashAlgo = algo;
            document.querySelectorAll('#tab-sign .hash-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            document.getElementById('sign-hash-' + algo).classList.add('selected');
        }

        function parseKey(keyStr) {
            const match = keyStr.match(/d:\s*(\d+),\s*n:\s*(\d+)|e:\s*(\d+),\s*n:\s*(\d+)/);
            if (!match) return null;
            
            if (match[1]) {
                return { d: parseInt(match[1]), n: parseInt(match[2]) };
            } else {
                return { e: parseInt(match[3]), n: parseInt(match[4]) };
            }
        }

        function signMessage() {
            const message = document.getElementById('sign-message').value;
            const keyStr = document.getElementById('sign-private-key').value;
            
            if (!message || !keyStr) {
                document.getElementById('sign-result').innerHTML = 
                    '<div class="error">‚ùå Bitte f√ºlle alle Felder aus!</div>';
                return;
            }
            
            const key = parseKey(keyStr);
            if (!key || !key.d) {
                document.getElementById('sign-result').innerHTML = 
                    '<div class="error">‚ùå Ung√ºltiger privater Schl√ºssel!</div>';
                return;
            }
            
            // Calculate hash
            const hash = getHash(message, signHashAlgo);
            const hashNum = parseInt(hash.substring(0, 8), 16) % key.n;
            
            // Sign (encrypt hash with private key)
            const signature = modPow(hashNum, key.d, key.n);
            
            const algoName = signHashAlgo === 'simple' ? 'Simple Hash' : 
                           signHashAlgo === 'md5' ? 'MD5' : 'SHA-256';
            
            document.getElementById('sign-result').innerHTML = `
                <div class="success-box">
                    <h4>‚úÖ Nachricht signiert!</h4>
                    <p><strong>Hash-Algorithmus:</strong> ${algoName}</p>
                    <p><strong>Hash-Wert:</strong></p>
                    <div class="key-display">${hash}</div>
                    <p><strong>Hash (numerisch):</strong> ${hashNum}</p>
                    <p><strong>Signatur:</strong></p>
                    <div class="key-display">${signature}</div>
                    <button class="copy-btn" onclick="copyText('${signature}')">üìã Signatur kopieren</button>
                </div>
                <div class="info-box" style="margin-top: 20px;">
                    <h4>üì§ Zum Versenden:</h4>
                    <p>1. Kopiere die Signatur</p>
                    <p>2. Sende die <strong>Nachricht</strong> + <strong>Signatur</strong> an den Empf√§nger</p>
                    <p>3. Der Empf√§nger ben√∂tigt deinen <strong>√∂ffentlichen Schl√ºssel</strong> zur Verifikation</p>
                </div>
            `;
        }

        function copyText(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert('Signatur kopiert!');
            });
        }

        // Verification
        function selectVerifyHash(algo) {
            verifyHashAlgo = algo;
            document.querySelectorAll('#tab-verify .hash-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            document.getElementById('verify-hash-' + algo).classList.add('selected');
        }

        function verifySignature() {
            const message = document.getElementById('verify-message').value;
            const signatureStr = document.getElementById('verify-signature').value;
            const keyStr = document.getElementById('verify-public-key').value;
            
            if (!message || !signatureStr || !keyStr) {
                document.getElementById('verify-result').innerHTML = 
                    '<div class="error">‚ùå Bitte f√ºlle alle Felder aus!</div>';
                return;
            }
            
            const key = parseKey(keyStr);
            if (!key || !key.e) {
                document.getElementById('verify-result').innerHTML = 
                    '<div class="error">‚ùå Ung√ºltiger √∂ffentlicher Schl√ºssel!</div>';
                return;
            }
            
            const signature = parseInt(signatureStr.trim());
            if (isNaN(signature)) {
                document.getElementById('verify-result').innerHTML = 
                    '<div class="error">‚ùå Ung√ºltige Signatur!</div>';
                return;
            }
            
            // Calculate hash of received message
            const hash = getHash(message, verifyHashAlgo);
            const hashNum = parseInt(hash.substring(0, 8), 16) % key.n;
            
            // Decrypt signature with public key
            const decryptedHash = modPow(signature, key.e, key.n);
            
            const algoName = verifyHashAlgo === 'simple' ? 'Simple Hash' : 
                           verifyHashAlgo === 'md5' ? 'MD5' : 'SHA-256';
            
            if (hashNum === decryptedHash) {
                document.getElementById('verify-result').innerHTML = `
                    <div class="success-box">
                        <h3>‚úÖ Signatur g√ºltig!</h3>
                        <p><strong>Hash-Algorithmus:</strong> ${algoName}</p>
                        <p><strong>Berechneter Hash:</strong></p>
                        <div class="key-display">${hash}</div>
                        <p><strong>Hash (numerisch):</strong> ${hashNum}</p>
                        <p><strong>Entschl√ºsselter Hash aus Signatur:</strong> ${decryptedHash}</p>
                        <p style="margin-top: 15px;">‚úÖ Die Nachricht ist <strong>authentisch</strong> und <strong>unver√§ndert</strong>!</p>
                        <p>‚úÖ Sie stammt vom Besitzer des privaten Schl√ºssels!</p>
                    </div>
                `;
            } else {
                document.getElementById('verify-result').innerHTML = `
                    <div class="error">
                        <h3>‚ùå Signatur ung√ºltig!</h3>
                        <p><strong>Berechneter Hash:</strong> ${hashNum}</p>
                        <p><strong>Entschl√ºsselter Hash aus Signatur:</strong> ${decryptedHash}</p>
                        <p style="margin-top: 15px;">‚ùå Die Nachricht wurde ver√§ndert ODER</p>
                        <p>‚ùå Die Signatur stammt nicht vom angegebenen Absender ODER</p>
                        <p>‚ùå Die Hash-Funktion stimmt nicht √ºberein</p>
                    </div>
                `;
            }
        }

        // Complete Communication
        function selectCompleteHash(algo) {
            completeHashAlgo = algo;
            document.querySelectorAll('#tab-complete .hash-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            document.getElementById('complete-hash-' + algo).classList.add('selected');
        }

        function useKeyA(type) {
            if (!keysA) {
                alert('Bitte generiere zuerst Schl√ºssel A im Schl√ºssel-Tab!');
                return;
            }
            
            if (type === 'private') {
                document.getElementById('complete-my-private').value = 
                    `d: ${keysA.privateKey.d}, n: ${keysA.privateKey.n}`;
            } else if (type === 'public-receive') {
                document.getElementById('complete-sender-public').value = 
                    `e: ${keysA.publicKey.e}, n: ${keysA.publicKey.n}`;
            }
        }

        function useKeyB(type) {
            if (!keysB) {
                alert('Bitte generiere zuerst Schl√ºssel B im Schl√ºssel-Tab!');
                return;
            }
            
            if (type === 'public') {
                document.getElementById('complete-receiver-public').value = 
                    `e: ${keysB.publicKey.e}, n: ${keysB.publicKey.n}`;
            } else if (type === 'private-receive') {
                document.getElementById('complete-my-private-receive').value = 
                    `d: ${keysB.privateKey.d}, n: ${keysB.privateKey.n}`;
            }
        }

        function sendCompleteMessage() {
            const message = document.getElementById('complete-message').value;
            const myPrivateKeyStr = document.getElementById('complete-my-private').value;
            const receiverPublicKeyStr = document.getElementById('complete-receiver-public').value;
            
            if (!message || !myPrivateKeyStr || !receiverPublicKeyStr) {
                document.getElementById('complete-send-result').innerHTML = 
                    '<div class="error">‚ùå Bitte f√ºlle alle Felder aus!</div>';
                return;
            }
            
            const myPrivateKey = parseKey(myPrivateKeyStr);
            const receiverPublicKey = parseKey(receiverPublicKeyStr);
            
            if (!myPrivateKey || !myPrivateKey.d || !receiverPublicKey || !receiverPublicKey.e) {
                document.getElementById('complete-send-result').innerHTML = 
                    '<div class="error">‚ùå Ung√ºltige Schl√ºssel!</div>';
                return;
            }
            
            // 1. Create hash
            const hash = getHash(message, completeHashAlgo);
            const hashNum = parseInt(hash.substring(0, 8), 16) % myPrivateKey.n;
            
            // 2. Sign hash with private key
            const signature = modPow(hashNum, myPrivateKey.d, myPrivateKey.n);
            
            // 3. Encrypt message with receiver's public key (simplified: just encode)
            let encrypted = '';
            for (let i = 0; i < message.length; i++) {
                const charCode = message.charCodeAt(i);
                const enc = modPow(charCode, receiverPublicKey.e, receiverPublicKey.n);
                encrypted += enc + (i < message.length - 1 ? ',' : '');
            }
            
            // Display results
            const algoName = completeHashAlgo === 'simple' ? 'Simple Hash' : 
                           completeHashAlgo === 'md5' ? 'MD5' : 'SHA-256';
            
            document.getElementById('complete-send-result').innerHTML = `
                <div class="success-box">
                    <h4>‚úÖ Nachricht vorbereitet!</h4>
                    <p><strong>1. Hash berechnet (${algoName}):</strong></p>
                    <div class="key-display" style="font-size: 0.8em;">${hash}</div>
                    <p><strong>2. Hash signiert:</strong> ${signature}</p>
                    <p><strong>3. Nachricht verschl√ºsselt</strong></p>
                    <p style="margin-top: 15px;">üì§ Die verschl√ºsselte Nachricht und Signatur wurden an den Empf√§nger √ºbertragen!</p>
                </div>
            `;
            
            // Fill receiver fields
            document.getElementById('complete-encrypted').value = encrypted;
            document.getElementById('complete-received-signature').value = signature;
        }

        function receiveCompleteMessage() {
            const encrypted = document.getElementById('complete-encrypted').value;
            const signatureStr = document.getElementById('complete-received-signature').value;
            const myPrivateKeyStr = document.getElementById('complete-my-private-receive').value;
            const senderPublicKeyStr = document.getElementById('complete-sender-public').value;
            
            if (!encrypted || !signatureStr || !myPrivateKeyStr || !senderPublicKeyStr) {
                document.getElementById('complete-receive-result').innerHTML = 
                    '<div class="error">‚ùå Bitte f√ºlle alle Felder aus!</div>';
                return;
            }
            
            const myPrivateKey = parseKey(myPrivateKeyStr);
            const senderPublicKey = parseKey(senderPublicKeyStr);
            const signature = parseInt(signatureStr.trim());
            
            if (!myPrivateKey || !myPrivateKey.d || !senderPublicKey || !senderPublicKey.e || isNaN(signature)) {
                document.getElementById('complete-receive-result').innerHTML = 
                    '<div class="error">‚ùå Ung√ºltige Eingaben!</div>';
                return;
            }
            
            // 1. Decrypt message with private key
            const encryptedParts = encrypted.split(',').map(x => parseInt(x.trim()));
            let decrypted = '';
            for (let enc of encryptedParts) {
                const charCode = modPow(enc, myPrivateKey.d, myPrivateKey.n);
                decrypted += String.fromCharCode(charCode);
            }
            
            // 2. Calculate hash of decrypted message
            const hash = getHash(decrypted, completeHashAlgo);
            const hashNum = parseInt(hash.substring(0, 8), 16) % senderPublicKey.n;
            
            // 3. Verify signature
            const decryptedHash = modPow(signature, senderPublicKey.e, senderPublicKey.n);
            
            const algoName = completeHashAlgo === 'simple' ? 'Simple Hash' : 
                           completeHashAlgo === 'md5' ? 'MD5' : 'SHA-256';
            
            if (hashNum === decryptedHash) {
                document.getElementById('complete-receive-result').innerHTML = `
                    <div class="success-box">
                        <h3>‚úÖ Nachricht erfolgreich empfangen!</h3>
                        <p><strong>1. Nachricht entschl√ºsselt:</strong></p>
                        <div class="key-display">${decrypted}</div>
                        <p><strong>2. Hash berechnet (${algoName}):</strong></p>
                        <div class="key-display" style="font-size: 0.8em;">${hash}</div>
                        <p><strong>3. Signatur verifiziert:</strong></p>
                        <p>Berechneter Hash: ${hashNum}</p>
                        <p>Entschl√ºsselter Hash: ${decryptedHash}</p>
                        <p style="margin-top: 15px; font-size: 1.2em;">
                            ‚úÖ Die Nachricht ist <strong>authentisch</strong> und <strong>unver√§ndert</strong>!<br>
                            ‚úÖ Sie stammt vom richtigen Absender!<br>
                            ‚úÖ Niemand konnte sie unterwegs lesen!
                        </p>
                    </div>
                `;
            } else {
                document.getElementById('complete-receive-result').innerHTML = `
                    <div class="error">
                        <h3>‚ùå Signatur ung√ºltig!</h3>
                        <p><strong>Entschl√ºsselte Nachricht:</strong></p>
                        <div class="key-display">${decrypted}</div>
                        <p><strong>Berechneter Hash:</strong> ${hashNum}</p>
                        <p><strong>Entschl√ºsselter Hash:</strong> ${decryptedHash}</p>
                        <p style="margin-top: 15px;">
                            ‚ùå Die Nachricht wurde m√∂glicherweise ver√§ndert!<br>
                            ‚ùå Oder sie stammt nicht vom angegebenen Absender!
                        </p>
                    </div>
                `;
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Set initial hash input
            if (document.getElementById('hash-input')) {
                calculateHash();
            }
        });
    </script>
</body>
</html>
